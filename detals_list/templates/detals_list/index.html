{% extends "base.html" %}
{% load static %}
{% block title %}
	Список деталей
{% endblock title %}
{% block page_title %}
	Список деталей			
{% endblock page_title %}
{% block mainpanel %}
<link rel="stylesheet" href="{% static "css/detals_list.css" %}">
<link rel="stylesheet" href="{% static "css/donor_panel.css" %}">
<div class="mainpanel detals_list">
	<div class="list">
		<div class="filterBack">
			<div class="filtePanel">
				<div class="smallFilter">
					<form action="/lk/detals_list/" method="POST">
						{% csrf_token %}
						<input type="hidden" name="type_filter" value="small">
						<div class="apply-filter" style="text-align: center;" onclick="this.parentElement.submit()">
							<img style="width: 55%;" src="{% static "img/apply.png" %}" >
						</div>
						<div class="smallFilterParam">
							<input list="price-list" id="myBrowser" name="param_filter" class="form-control" placeholder="Диапазон цен" value="{% if selected %}{{selected.price}}{% else %}{% endif %}">
							<datalist id="price-list">
								<option value="Все цены">
								<option value="Тестовая строка 2">
								<option value="Тестовая строка 3">
							</datalist>
						</div>
						<div class="smallFilterParam">
							<input list="detal-list" id="myBrowser" name="param_filter" class="form-control" placeholder="Деталь" value="{% if selected %}{{selected.detal}}{% else %}{% endif %}">
							<datalist id="detal-list">
								<option value="Все детали">
								{% for elem in filter_values.detal %}
									<option value="{{elem.title}}"></option>
								{% endfor %}
							</datalist>
						</div>
						<div class="smallFilterParam">
							<input list="mark-list" id="myBrowser" name="param_filter" class="form-control" placeholder="Марка" value="{% if selected %}{{selected.mark}}{% else %}{% endif %}">
							<datalist id="mark-list">
								<option value="Все марки">
								{% for elem in filter_values.mark %}
									<option value="{{elem.title}}">
								{% endfor %}
							</datalist>
						</div>
						<div class="smallFilterParam">
							<input list="model-list" id="myBrowser" name="param_filter" class="form-control" placeholder="Модель" value="{% if selected %}{{selected.model}}{% else %}{% endif %}">
							<datalist id="model-list">
								<option value="Все модели">
								<option value="Тестовая строка 1">
								<option value="Тестовая строка 2">
							</datalist>
						</div>
						<div class="smallFilterParam">
							<input list="generation-list" id="myBrowser" name="param_filter" class="form-control" placeholder="Поколение" value="{% if selected %}{{selected.generation}}{% else %}{% endif %}">
							<datalist id="generation-list">
								<option value="Все поколения">
								<option value="Тестовая строка 1">
								<option value="Тестовая строка 2">
							</datalist>
						</div>
						<div class="smallFilterParam">
							<input list="number-list" id="myBrowser" name="param_filter" class="form-control" placeholder="Оригинальный номер" value="{% if selected %}{{selected.number}}{% else %}{% endif %}">
							<datalist id="number-list">
								<option value="Все номера">
								<option value="Тестовая строка 1">
								<option value="Тестовая строка 2">
							</datalist>
						</div>
						<div class="smallFilterParam">
							<input list="stocks-list" id="myBrowser" name="param_filter" class="form-control" placeholder="Склад" value="{% if selected %}{{selected.stock}}{% else %}{% endif %}">
							<datalist id="stocks-list">
								{% for elem in filter_values.stock %}
									<option value="{{elem.title}}">
								{% endfor %}
							</datalist>
						</div>
						<div class="smallFilterParam">
							<input list="stocks-list2" id="myBrowser" name="param_filter" class="form-control" placeholder="Складская ячейка" value="{% if selected %}{{selected.cell}}{% else %}{% endif %}">
							<datalist id="stocks-list2">
								<option value="Все ячейки">
								<option value="Тестовая строка 1">
								<option value="Тестовая строка 2">
							</datalist>
						</div>
						
					</form>
				</div>
				<hr>
				<div class="fullFilter">
					<form action="/lk/detals_list/" method="POST">
						{% csrf_token %}
						<input type="hidden" name="type_filter" value="full">
						<div class="fullFilterButtonBlock">
							<div class="resetFilterButton">
								<input type="image" src="{% static "img/reset.png" %}">
							</div>
							<div class="applyFilterButton" >
								<input type="image" src="{% static "img/apply.png" %}">
							</div>
						</div>
						<div class="leftFilterBlock">
							<div class="filterGroup price priceFilter">
								<div class="input-group input-group-sm ">
									<div class="input-group-prepend">
										<span class="input-group-text" id="inputGroup-sizing-sm">Min</span>
									</div>
									<input type="number" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="0₽" name="priceFilter" step="50" {% if selected_price.0 != 0 %}value="{{selected_price.0}}"{% endif %}>
								</div>
								<div class="input-group input-group-sm">
									<input type="number" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="999 999₽" name="priceFilter" step="50" {% if selected_price.1 != 999999 %}value="{{selected_price.1}}"{% endif %}>
									<div class="input-group-prepend">
										<span class="input-group-text" id="inputGroup-sizing-sm">Max</span>
									</div>
								</div>
							</div>
							<div class="leftCol">
								<div class="filterGroup detalFilter left ">
									{% for elem in detals_filter %}
										<div class="oneFIlterValue">
											<div class="custom-control custom-checkbox">
												{% if elem.value in selected_checkbox_detal %}
													<input type="checkbox" class="custom-control-input" id="{{elem.pk}}_detal" onclick="add_name(this)" value="{{elem.value}}" checked name="detal">
												{% else %}
													<input type="checkbox" class="custom-control-input" id="{{elem.pk}}_detal" onclick="add_name(this)" value="{{elem.value}}">
												{% endif %}
												<label class="custom-control-label" for="{{elem.pk}}_detal">{{elem.title}}</label>
											</div>
										</div>
									{% endfor %}
								</div>
							</div>
						</div>
						
						<div class="filterGroup donorFilter">
							{% for elem in donors_filter %}
								<div class="oneFIlterValue">
									<div class="custom-control custom-checkbox">
										{% if elem.pk in selected_checkbox_donor %}
											<input type="checkbox" class="custom-control-input" id="{{elem.pk}}_donor" onclick="add_name(this)" value="{{elem.pk}}" checked name="donor">
										{% else %}
											<input type="checkbox" class="custom-control-input" id="{{elem.pk}}_donor" onclick="add_name(this)" value="{{elem.pk}}">
										{% endif %}
											<label class="custom-control-label" for="{{elem.pk}}_donor">{{elem}}</label>
									</div>
								</div>
							{% endfor %}
						</div>
						<div class="filterGroup vinFilter">
							<div class="oneFIlterValue">
								<div class="custom-control custom-checkbox">
									<input type="checkbox" class="custom-control-input" id="customCheck1">
									<label class="custom-control-label" for="customCheck1">06V288B2</label>
								</div>
							</div>
						</div>
						<div class="filterGroup skladFilter">
							{% for elem in stocks_filters %}
								<div class="oneFIlterValue">
									<div class="custom-control custom-checkbox">
										{% if elem.pk in selected_stock %}
											<input type="checkbox" class="custom-control-input" onclick="add_name(this)" id="{{elem.pk}}_stock" checked name="stock" value="{{elem.pk}}">
										{% else %}
											<input type="checkbox" class="custom-control-input" onclick="add_name(this)" id="{{elem.pk}}_stock" value="{{elem.pk}}">
										{% endif %}
											<label class="custom-control-label" for="{{elem.pk}}_stock">{{elem.title}}</label>
									</div>
								</div>
							{% endfor %}
						</div>
					</form>
				</div>
			</div>
			
		</div>
		<div class="showFilterButton" onclick="show_filter(this)">
				<label>Фильтры</label><i class="fas fa-angle-double-down fa-lg"></i>
			</div>
		<table class="tableDetals ">
			<thead class="thead-dark">
				<tr>
					<th class="detalCheckBox">
						<input id="select_all" class="selectAll" type="checkbox" onchange="select_all()">
					</th>
					
					<th class="detalNumber">№</th>
					<th class="detalTitle">Деталь</th>
					<th class="detalDonor">Автомобиль-донор</th>
					<th class="detalPrice">Цена</th>
					<th class="detalVIN">VIN</th>
					<th class="detalSklad">Склад</th>
					<th class="detalPhotoMin">Фотография</th>
					<th class="detalOther">Описание</th>
				</tr>
			</thead>
			<tbody>
				{% for detal in all_detals %}
					{% if detal.count < 100 %}
						<tr data-content="{{detal.detal.pk}}">
							<td class="detalCheckBox">
								<input id="checkbox" type="checkbox" onchange="selected(this)">
							</td>
							<td class="detalNumber">{{detal.count}}</td>
							<td class="detalTitle">{{detal.detal}}</td>
							<td class="detalDonor" onclick="move_panel(this)">
								<a href="#" id="{{detal.detal.donor_info.pk}}">{{detal.detal.donor_info}}</a>
							</td>
							<td class="detalPrice" ondblclick="edit_price(this)"><span>{{detal.detal.price}}</span> ₽</td>
							<td class="detalVIN">06V288B2</td>
							<td class="detalSklad">{{detal.detal.stockroom}}</td>
							<td class="detalPhotoImg">
								<a href="#img1">
									<img src="{% static "img/image_mini.png" %}" alt="" onclick="view_detal_photo(this)">
								</a>
								<a href="#close" class="fulImg" id="img1" onclick="closePhoto(this)">
								</a>
							</td>
							<td class="detalOther">{{detal.detal.description}}</td>
						</tr>
					{% endif %}
				{% endfor %}
			</tbody>
		</table>
		<div class="controlPanel">
			<div class="titleSelect">
				<label>Выбранно деталей:</label><span>0</span>
				<br>
				<label>На общую сумму:</label><span>0</span> руб.
			</div>
			<div class="transfer">
				<button class="btn btn-info">Переместить</button>
			</div>
			<div class="remove">
				<button class="btn btn-success">Что-то сделать</button>
			</div>
			<div class="remove">
				<button class="btn btn-danger">Списать</button>
			</div>
		</div>
	<div class="donor in-detal-list">
		<div class="donorContent">
			<input name="idDonor" id="idDonor" type="hidden" value="{{new_donor.pk}}">
			<div class="mainInfo" id="mainInfo">
				
				<div class="donorTabs">
					<div class="tabInfo active" onclick="donorTabs(this)" data-content="params">
						<span>Общая информация</span>
					</div>
					<div class="tabPhoto" onclick="donorTabs(this)" data-content="photo">
						<span>Фотография</span>							
					</div>
				</div>
		
				<div class="donorFields">
					<div class="donorParmas show">
						<div class="vin-field">
							<div class="input-group-prepend">
								<div class="paramTitle">
									<span class="nameParam">VIN или номер кузова:</span>
								</div>
								<div class="paramContent">
									{{form_donor.vin}}
								</div>
							</div>
						</div>
						<div class="col">
							<div class="leftParam" >
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam" id="">Марка:</span>
									</div>
									<div class="paramContent">
										{{form_donor.mark}}
									</div>
								</div>
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam" id="">Модель:</span>
									</div>
									<div class="paramContent">
										{{form_donor.model}}
									</div>
								</div>
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam" id="">Поколение:</span>
									</div>
									<div class="paramContent">
										{{form_donor.generation}}
									</div>
								</div>
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam" id="">Год выпуска:</span>
									</div>
									<div class="paramContent">
										{{form_donor.year}}
									</div>
								</div>
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam" id="">Тип кузова:</span>
									</div>
									<div class="paramContent">
										{{form_donor.kuzov}}
									</div>
								</div>
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam">Пробег:</span>
									</div>
									<div class="paramContent">
										{{form_donor.probeg}}
									</div>
								</div>
							</div>
							<div class="rightParam">
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam" id="">Тип двигателя:</span>
									</div>
									<div class="paramContent">
										{{form_donor.engine_type}}
									</div>
								</div>
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam" id="">Объем:</span>
									</div>
									<div class="paramContent">
										{{form_donor.engine_size}}
									</div>
								</div>
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam" id="">КПП:</span>
									</div>
									<div class="paramContent">
										{{form_donor.kpp}}
									</div>
								</div>
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam" id="">Цвет:</span>
									</div>
									<div class="paramContent">
										{{form_donor.color}}
									</div>
								</div>
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam" id="">Руль:</span>
									</div>
									<div class="paramContent">
										{{form_donor.helm}}
									</div>
								</div>
								<div class="oneParamBlock">
									<div class="paramTitle">
										<span class="nameParam" id="">Привод:</span>
									</div>
									<div class="paramContent">
										{{form_donor.privod}}
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="donorPhoto">
						<img src="{% static "img/addPhoto.png" %}" alt="">
					</div>
				</div>
		
				<div class="buttonBlock">
					<div>
						<button id="edit" onclick="editDonor(mainInfo)" type="button" class="btn btn-primary" disabled>Изменить</button>
					</div>
					<div>
						<button id="save" onclick="saveDonor()" type="button" class="btn btn-success">Сохранить</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script src="{% static "js/detals_list.js" %}"></script>
{% endblock mainpanel %}